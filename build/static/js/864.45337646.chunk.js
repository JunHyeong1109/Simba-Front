"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[864],{864:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var t=a(338),i=a(43),r=a(674),n=a(579);const l="/map",c="/manage",d=8,o=12;function m(){var e;const s=(0,t.Zp)(),a=(0,t.KC)(),m=null!==(e=null===a||void 0===a?void 0:a.user)&&void 0!==e?e:null,[u,h]=(0,i.useState)(!0),[v,j]=(0,i.useState)(""),[x,p]=(0,i.useState)([]),[N,y]=(0,i.useState)(!0),[f,g]=(0,i.useState)(""),[b,A]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e=!0;return(async()=>{try{h(!0),j("");const{data:a}=await r.Ay.get("/itda/missions/joinable"),t=Array.isArray(a)?a:(null===a||void 0===a?void 0:a.items)||[],i=new Map;for(const e of t){var s;const a=e.store||{},t=null!==(s=a.id)&&void 0!==s?s:e.storeId;if(!t)continue;const r=e.posterUrl||e.poster||e.imageUrl||e.thumbnailUrl||"";i.has(t)?i.get(t).count+=1:i.set(t,{storeId:t,name:a.name||e.storeName||"\ub9e4\uc7a5",address:a.address||e.address||"",poster:r,count:1})}const n=Array.from(i.values()).sort((e,s)=>s.count-e.count).slice(0,d);if(!e)return;p(n)}catch(i){var a,t;if(!e)return;j((null===i||void 0===i||null===(a=i.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"\ubbf8\uc158/\ub9e4\uc7a5 \ubbf8\ub9ac\ubcf4\uae30\ub97c \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4."),p([])}finally{e&&h(!1)}})(),()=>{e=!1}},[]),(0,i.useEffect)(()=>{let e=!0;return(async()=>{try{y(!0),g("");const{data:s}=await r.Ay.get("/itda/stores"),a=(Array.isArray(s)?s:(null===s||void 0===s?void 0:s.items)||[]).slice(0,o);if(0===a.length){if(!e)return;return void A([])}const t=(await Promise.allSettled(a.map(async e=>{var s;const{data:a}=await r.Ay.get("/itda/stores/".concat(e.id,"/summary")),t="string"===typeof a?a:null!==(s=null===a||void 0===a?void 0:a.summary)&&void 0!==s?s:"";return{id:e.id,name:e.name,summary:t}}))).filter(e=>"fulfilled"===e.status).map(e=>e.value);if(!e)return;A(t)}catch(t){var s,a;if(!e)return;g((null===t||void 0===t||null===(s=t.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"\ub9e4\uc7a5 \uc694\uc57d\uc744 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4."),A([])}finally{e&&y(!1)}})(),()=>{e=!1}},[]);const C=x.length>0,k=b.length>0;return(0,n.jsxs)("div",{className:"main-wrap",children:[(0,n.jsx)("h2",{className:"main-title",children:"\ubb34\uc5c7\uc744 \ud558\uc2dc\uaca0\uc5b4\uc694?"}),(0,n.jsxs)("div",{className:"main-grid",children:[(0,n.jsxs)("button",{type:"button",className:"main-card",onClick:()=>s(l),"aria-label":"\ubbf8\uc158 \uc774\ubca4\ud2b8 \uc9c0\ub3c4 \ubcf4\uae30",children:[(0,n.jsx)("div",{className:"card-emoji","aria-hidden":!0,children:"\ud83d\uddfa\ufe0f"}),(0,n.jsx)("div",{className:"card-title",children:"Itda \uc774\ubca4\ud2b8 \ucc3e\uc544\ubcf4\uae30!"}),(0,n.jsx)("div",{className:"card-desc",children:"\uc9c4\ud589 \uac00\ub2a5\ud55c \ubbf8\uc158\uc744 \uc9c0\ub3c4\uc5d0\uc11c \ud655\uc778\ud574\uc694."})]}),(0,n.jsxs)("button",{type:"button",className:"main-card",onClick:()=>{if(!m)return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."),void s("/login");(e=>{if(!e)return!1;const s=(e.role?String(e.role):"").toUpperCase();if(s)return"OWNER"===s||"ADMIN"===s;const a=Array.isArray(e.roles)?e.roles.map(e=>String(e).toUpperCase()):[];return a.includes("OWNER")||a.includes("ADMIN")})(m)?s(c):alert("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. (\ub9ac\ubdf0\uc5b4\ub294 \uc811\uadfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.)")},"aria-label":"\ub0b4 \ub9e4\uc7a5 \uad00\ub9ac\ub85c \uc774\ub3d9",children:[(0,n.jsx)("div",{className:"card-emoji","aria-hidden":!0,children:"\ud83c\udfea"}),(0,n.jsx)("div",{className:"card-title",children:"\ub9e4\uc7a5 \uad00\ub9ac"}),(0,n.jsx)("div",{className:"card-desc",children:"\ub4f1\ub85d\ud55c \ub9e4\uc7a5\uc744 \ud655\uc778\ud558\uace0 \ud3b8\uc9d1\ud574\uc694."})]})]}),(0,n.jsxs)("div",{className:"main-sections vertical",children:[(0,n.jsxs)("section",{className:"home-section",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("h3",{className:"section-title",children:"\ubbf8\uc158\uc774 \uc62c\ub77c\uc628 \ub9e4\uc7a5"}),(0,n.jsx)("button",{type:"button",className:"link-btn",onClick:()=>s(l),children:"\uc804\uccb4 \ubcf4\uae30 \u2192"})]}),u&&(0,n.jsx)("div",{className:"section-empty",children:"\ubd88\ub7ec\uc624\ub294 \uc911..."}),!u&&v&&(0,n.jsx)("div",{className:"section-error",children:v}),!u&&!v&&!C&&(0,n.jsx)("div",{className:"section-empty",children:"\ud604\uc7ac \uc9c4\ud589 \uac00\ub2a5\ud55c \ubbf8\uc158\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),!u&&!v&&C&&(0,n.jsx)("ul",{className:"store-preview-grid",children:x.map(e=>{return(0,n.jsxs)("li",{className:"store-card",title:e.name,onClick:()=>s("".concat(l,"?storeId=").concat(e.storeId)),children:[(0,n.jsxs)("div",{className:"store-thumb",children:[e.poster?(0,n.jsx)("img",{src:e.poster,alt:"\ud3ec\uc2a4\ud130"}):(0,n.jsx)("div",{className:"store-thumb-placeholder",children:"\ud3ec\uc2a4\ud130 \uc5c6\uc74c"}),(0,n.jsx)("span",{className:"badge-count","aria-label":"\uc9c4\ud589\uc911 \ubbf8\uc158 ".concat(e.count,"\uac1c"),children:(a=e.count,a>99?"99+":String(a||0))})]}),(0,n.jsxs)("div",{className:"store-body",children:[(0,n.jsx)("div",{className:"store-name",children:e.name}),e.address&&(0,n.jsx)("div",{className:"store-addr",children:e.address})]})]},e.storeId);var a})})]}),(0,n.jsxs)("section",{className:"home-section",children:[(0,n.jsx)("div",{className:"section-header",children:(0,n.jsx)("h3",{className:"section-title",children:"\ub9e4\uc7a5\uc758 \ud55c \uc904 \ud3c9\uac00!"})}),N&&(0,n.jsx)("div",{className:"section-empty",children:"\ubd88\ub7ec\uc624\ub294 \uc911..."}),!N&&f&&(0,n.jsx)("div",{className:"section-error",children:f}),!N&&!f&&!k&&(0,n.jsx)("div",{className:"section-empty",children:"\uc694\uc57d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}),!N&&!f&&k&&(0,n.jsx)("ul",{className:"summary-list",children:b.map(e=>(0,n.jsxs)("li",{className:"summary-item",title:e.name,onClick:()=>s("".concat(l,"?storeId=").concat(e.id)),children:[(0,n.jsx)("div",{className:"summary-name",children:e.name}),(0,n.jsx)("div",{className:"summary-text",children:e.summary||"\uc694\uc57d\uc774 \uc81c\uacf5\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4."})]},e.id))})]})]})]})}function u(){return(0,n.jsx)("div",{"data-app":"manage-shop",children:(0,n.jsxs)(t.BV,{children:[(0,n.jsx)(t.qh,{index:!0,element:(0,n.jsx)(m,{})}),(0,n.jsx)(t.qh,{path:"*",element:(0,n.jsx)(t.C5,{to:".",replace:!0})})]})})}}}]);
//# sourceMappingURL=864.45337646.chunk.js.map