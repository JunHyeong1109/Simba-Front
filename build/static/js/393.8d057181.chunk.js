"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[393],{393:(e,l,n)=>{n.r(l),n.d(l,{default:()=>c});var t=n(43),s=n(338),a=n(674),d=n(579);function i(e){let{open:l,defaultAddress:n="",onClose:s,onConfirm:a}=e;const i=(0,t.useRef)(null),o=(0,t.useRef)(null),r=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(null),v=(0,t.useRef)(null),[m,p]=(0,t.useState)(n),[h,x]=(0,t.useState)({lat:null,lng:null}),[g,j]=(0,t.useState)(""),[y,b]=(0,t.useState)(""),[f,N]=(0,t.useState)(null),[w,k]=(0,t.useState)(""),S={lat:37.5665,lng:126.978},C=async()=>{var e;if(null===(e=window.kakao)||void 0===e||!e.maps)return void N("Kakao Maps SDK\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. index.html\uc744 \ud655\uc778\ud558\uc138\uc694.");if(!window.kakao.maps.services)return void N("Kakao Maps services \ub77c\uc774\ube0c\ub7ec\ub9ac\uac00 \ud544\uc694\ud569\ub2c8\ub2e4. SDK URL\uc5d0 libraries=services\ub97c \ud3ec\ud568\ud558\uc138\uc694.");N(null);const l=await new Promise(e=>{if(!navigator.geolocation)return e(S);navigator.geolocation.getCurrentPosition(l=>e({lat:l.coords.latitude,lng:l.coords.longitude}),()=>e(S),{enableHighAccuracy:!0,timeout:5e3})}),n=window.kakao,t=new n.maps.LatLng(l.lat,l.lng),s=new n.maps.Map(o.current,{center:t,level:3});c.current=s;const a=new n.maps.Marker({position:t,draggable:!0});a.setMap(s),u.current=a,v.current=new n.maps.services.Geocoder,x(l),A(l),setTimeout(()=>{s.relayout(),s.setCenter(a.getPosition())},0),n.maps.event.addListener(a,"dragend",()=>{const e=a.getPosition(),l={lat:e.getLat(),lng:e.getLng()};x(l),A(l),s.setCenter(e)})};(0,t.useEffect)(()=>{l&&(k(""),C())},[l]);const A=e=>{let{lat:l,lng:n}=e;const t=v.current;t&&t.coord2Address(n,l,(e,l)=>{var n,t,s,a;if(l!==window.kakao.maps.services.Status.OK||null===e||void 0===e||!e[0])return;const d=(null===(n=e.find(e=>e.road_address))||void 0===n||null===(t=n.road_address)||void 0===t?void 0:t.address_name)||"",i=(null===(s=e[0])||void 0===s||null===(a=s.address)||void 0===a?void 0:a.address_name)||"";j(d),b(i),p(d||i||"")})},L=e=>{if(null===e||void 0===e||!e.trim())return;const l=v.current;l&&l.addressSearch(e.trim(),(e,l)=>{if(l!==window.kakao.maps.services.Status.OK||null===e||void 0===e||!e[0])return;const{y:n,x:t,road_address:s,address:a}=e[0],d={lat:parseFloat(n),lng:parseFloat(t)};x(d),j((null===s||void 0===s?void 0:s.address_name)||""),b((null===a||void 0===a?void 0:a.address_name)||"");const i=new window.kakao.maps.LatLng(d.lat,d.lng);u.current.setPosition(i),c.current.setCenter(i)})},R=()=>{r.current&&(r.current.style.display="none")};return l?(0,d.jsx)("div",{ref:i,className:"addr-modal-overlay",onClick:e=>{e.target===i.current&&(null===s||void 0===s||s())},children:(0,d.jsxs)("div",{className:"addr-modal-container",onClick:e=>e.stopPropagation(),children:[(0,d.jsx)("div",{className:"addr-modal-header",children:(0,d.jsx)("strong",{children:"\uc8fc\uc18c \uc120\ud0dd"})}),(0,d.jsxs)("div",{className:"addr-modal-body",children:[f&&(0,d.jsx)("div",{className:"addr-error",children:f}),(0,d.jsxs)("div",{className:"addr-search-row",children:[(0,d.jsx)("input",{type:"text",className:"addr-input",placeholder:"\uc8fc\uc18c\ub97c \uc785\ub825\ud558\uc138\uc694 (\uc608: \uc11c\uc6b8\ud2b9\ubcc4\uc2dc \uc911\uad6c \uc138\uc885\ub300\ub85c 110)",value:w,onChange:e=>k(e.target.value),onKeyDown:e=>{"Enter"===e.key&&L(w)}}),(0,d.jsx)("button",{type:"button",className:"addr-btn",onClick:()=>L(w),children:"\uc8fc\uc18c\uac80\uc0c9"}),(0,d.jsx)("button",{type:"button",className:"addr-btn",onClick:()=>{var e;if(null===(e=window.daum)||void 0===e||!e.Postcode)return void N("\ub2e4\uc74c \uc6b0\ud3b8\ubc88\ud638 SDK\uac00 \ub85c\ub4dc\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. index.html\uc744 \ud655\uc778\ud558\uc138\uc694.");r.current.style.display="block";const l=document.getElementById("addr-postcode-embed");l.innerHTML="";new window.daum.Postcode({oncomplete:e=>{const l=e.roadAddress||e.jibunAddress||"";p(l),k(l),L(l),R()},onclose:()=>{},width:"100%",height:"100%"}).embed(l,{autoClose:!1})},children:"\uc6b0\ud3b8\ubc88\ud638"})]}),(0,d.jsx)("div",{ref:o,className:"addr-map"}),(0,d.jsxs)("div",{ref:r,className:"addr-postcode-layer",style:{display:"none"},children:[(0,d.jsxs)("div",{className:"addr-postcode-header",children:[(0,d.jsx)("span",{children:"\uc6b0\ud3b8\ubc88\ud638 \uac80\uc0c9"}),(0,d.jsx)("button",{type:"button",className:"addr-btn small",onClick:R,children:"\ub2eb\uae30"})]}),(0,d.jsx)("div",{id:"addr-postcode-embed",className:"addr-postcode-embed"})]}),(0,d.jsxs)("div",{className:"addr-info-row",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"addr-info-title",children:"\ub3c4\ub85c\uba85"}),(0,d.jsx)("div",{children:g||"-"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"addr-info-title",children:"\uc9c0\ubc88"}),(0,d.jsx)("div",{children:y||"-"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"addr-info-title",children:"\uc88c\ud45c"}),(0,d.jsx)("div",{children:h.lat&&h.lng?(0,d.jsxs)(d.Fragment,{children:[h.lat.toFixed(6),", ",h.lng.toFixed(6)]}):"-"})]})]})]}),(0,d.jsxs)("div",{className:"addr-modal-footer",children:[(0,d.jsx)("button",{type:"button",className:"addr-btn",onClick:s,children:"\ucde8\uc18c"}),(0,d.jsx)("button",{type:"button",className:"addr-btn confirm",onClick:()=>null===a||void 0===a?void 0:a({address:m,roadAddress:g,jibunAddress:y,latitude:h.lat,longitude:h.lng}),disabled:!m||!h.lat||!h.lng,children:"\ud655\uc778"})]})]})}):null}const o=function(){var e;const l=(0,s.g)(),n=(0,s.zy)(),o=null===l||void 0===l?void 0:l.id,r=new URLSearchParams(n.search).get("id"),c=null===(e=n.state)||void 0===e?void 0:e.id,u=n.pathname.split("/").filter(Boolean).pop(),v=/^\d+$/.test(u)?u:null,m=o||r||c||v||null,p=null!=m?String(m):null,h=!!p,[x,g]=(0,t.useState)(""),[j,y]=(0,t.useState)(""),[b,f]=(0,t.useState)(""),[N,w]=(0,t.useState)(""),[k,S]=(0,t.useState)(""),[C,A]=(0,t.useState)({lat:null,lng:null}),[L,R]=(0,t.useState)(!1),[P,F]=(0,t.useState)(!1),[K,_]=(0,t.useState)(null),[M,D]=(0,t.useState)(h),[E,T]=(0,t.useState)(""),q=e=>(e||"").replace(/[^0-9]/g,"");return(0,t.useEffect)(()=>{let e=!0;return h?((async()=>{try{var l,n,t,s;D(!0),T("");const{data:d}=await a.Ay.get("/itda/stores/".concat(p));if(!e)return;g((null===d||void 0===d?void 0:d.name)||""),y((null===d||void 0===d?void 0:d.ownerName)||(null===d||void 0===d?void 0:d.bossName)||""),f((null===d||void 0===d?void 0:d.businessNumber)||""),w((null===d||void 0===d?void 0:d.address)||""),S(void 0!==(null===d||void 0===d?void 0:d.category)&&null!==(null===d||void 0===d?void 0:d.category)?String(d.category):"");const i=null!==(l=null!==(n=null===d||void 0===d?void 0:d.latitude)&&void 0!==n?n:null===d||void 0===d?void 0:d.lat)&&void 0!==l?l:null,o=null!==(t=null!==(s=null===d||void 0===d?void 0:d.longitude)&&void 0!==s?s:null===d||void 0===d?void 0:d.lng)&&void 0!==t?t:null;A({lat:"number"===typeof i?i:i?Number(i):null,lng:"number"===typeof o?o:o?Number(o):null})}catch(r){var d,i,o;const e=null===r||void 0===r||null===(d=r.response)||void 0===d?void 0:d.status,l=(null===r||void 0===r||null===(i=r.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.message)||(null===r||void 0===r?void 0:r.message)||"\uac00\uac8c \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.";T("[".concat(null!==e&&void 0!==e?e:"ERR","] ").concat(l," (\uc694\uccad: /itda/stores/").concat(p,")")),console.warn("load store failed:",r)}finally{e&&D(!1)}})(),()=>{e=!1}):(D(!1),T(""),()=>{e=!1})},[p,h]),(0,d.jsxs)(d.Fragment,{children:[h&&M?(0,d.jsx)("div",{className:"loader",children:"\uac00\uac8c \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\u2026"}):h&&E?(0,d.jsx)("div",{className:"error",children:E}):(0,d.jsxs)("form",{className:"row",onSubmit:async e=>{if(e.preventDefault(),_(null),!x.trim()||!j.trim()||!b.trim()||!N.trim()||""===k)return void _({type:"error",text:"\ubaa8\ub4e0 \ud56d\ubaa9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."});if(10!==q(b).length)return void _({type:"error",text:"\uc0ac\uc5c5\uc790\ub4f1\ub85d\ubc88\ud638\ub294 \uc22b\uc790 10\uc790\ub9ac\uc5ec\uc57c \ud569\ub2c8\ub2e4. (\ud558\uc774\ud508 \uc81c\uc678)"});const l={name:x.trim(),category:Number(k),ownerName:j.trim(),businessNumber:q(b),address:N.trim(),latitude:C.lat,longitude:C.lng};try{var n;F(!0);const e=h?await a.Ay.put("/itda/stores/".concat(p),l):await a.Ay.post("/itda/stores",l),t=(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)||(h?"\uc218\uc815\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.":"\ub4f1\ub85d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.");_({type:"success",text:t}),h||(g(""),y(""),f(""),w(""),S(""),A({lat:null,lng:null}))}catch(d){var t,s;const e=(null===d||void 0===d||null===(t=d.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||(null===d||void 0===d?void 0:d.message)||(h?"\uc218\uc815 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.":"\ub4f1\ub85d \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.");_({type:"error",text:e})}finally{F(!1)}},children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{children:"\uc0c1\ud638\uba85"}),(0,d.jsx)("input",{className:"input ".concat(""===x?"is-placeholder":""),type:"text",value:x,placeholder:"\uc0c1\ud638\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",onChange:e=>g(e.target.value)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{children:"\uc5c5\uc885"}),(0,d.jsxs)("select",{className:"input ".concat(""===k?"is-placeholder":""),value:k,onChange:e=>S(e.target.value),children:[(0,d.jsx)("option",{value:"",disabled:!0,hidden:!0,children:"\uc5c5\uc885"}),[{value:0,label:"\uce74\ud398"},{value:1,label:"\uc2dd\ub2f9"},{value:2,label:"\uae30\ud0c0"}].map(e=>(0,d.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{children:"\ub300\ud45c\uba85"}),(0,d.jsx)("input",{className:"input ".concat(""===j?"is-placeholder":""),type:"text",value:j,placeholder:"\ub300\ud45c\uba85\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.",onChange:e=>y(e.target.value)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{children:"\uc0ac\uc5c5\uc790\ub4f1\ub85d\ubc88\ud638"}),(0,d.jsx)("input",{className:"input ".concat(""===b?"is-placeholder":""),type:"text",value:b,placeholder:"\uc0ac\uc5c5\uc790\ub4f1\ub85d\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694. (\uc608: 123-45-67890)",onChange:e=>f(e.target.value)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{children:"\uc8fc\uc18c"}),(0,d.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,d.jsx)("input",{className:"input ".concat(""===N?"is-placeholder":""),type:"text",value:N,placeholder:"\uc8fc\uc18c\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694.",readOnly:!0,onClick:()=>R(!0)}),(0,d.jsx)("button",{type:"button",className:"btn",onClick:()=>R(!0),children:"\uc8fc\uc18c \uc120\ud0dd"})]}),null!=C.lat&&null!=C.lng&&(0,d.jsxs)("small",{style:{color:"#666"},children:["\uc120\ud0dd \uc88c\ud45c: ",Number(C.lat).toFixed(6),", ",Number(C.lng).toFixed(6)]})]}),(0,d.jsx)("div",{style:{marginTop:16},children:(0,d.jsx)("button",{type:"submit",className:"btn",disabled:P,children:P?h?"\uc218\uc815 \uc911...":"\ub4f1\ub85d \uc911...":h?"\uc218\uc815 \uc644\ub8cc":"\uc644\ub8cc"})}),K&&(0,d.jsx)("p",{className:"message ".concat("error"===K.type?"error":"success"),style:{marginTop:8},children:K.text})]}),(0,d.jsx)(i,{open:L,defaultAddress:N,onClose:()=>R(!1),onConfirm:e=>{let{address:l,latitude:n,longitude:t}=e;w(l||""),A({lat:n,lng:t}),R(!1)}})]})};const r=function(){return(0,d.jsx)("div",{children:(0,d.jsx)(o,{})})};function c(){return(0,d.jsx)("div",{"data-app":"editshop",children:(0,d.jsxs)(s.BV,{children:[(0,d.jsx)(s.qh,{index:!0,element:(0,d.jsx)(r,{})}),(0,d.jsx)(s.qh,{path:"inner",element:(0,d.jsx)(o,{})}),(0,d.jsx)(s.qh,{path:"*",element:(0,d.jsx)(s.C5,{to:".",replace:!0})})]})})}}}]);
//# sourceMappingURL=393.8d057181.chunk.js.map