"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[677],{677:(e,a,i)=>{i.r(a),i.d(a,{default:()=>d});var l=i(338),t=i(43),s=i(674),n=i(579);function r(){const[e,a]=(0,t.useState)(null),[i,l]=(0,t.useState)(!0),r="REVIEWER"===((null===e||void 0===e?void 0:e.role)||"").toString().toUpperCase(),[d,c]=(0,t.useState)([]),[o,v]=(0,t.useState)(""),[u,m]=(0,t.useState)(0),[p,h]=(0,t.useState)(null),[x,j]=(0,t.useState)("latest"),[w,g]=(0,t.useState)(!1);(0,t.useEffect)(()=>{let e=!0;return(async()=>{try{const{data:i}=await s.Ay.get("/itda/me");e&&a(i||null)}catch(i){e&&a(null)}finally{e&&l(!1)}})(),()=>{e=!1}},[]);(0,t.useEffect)(()=>()=>{null!==p&&void 0!==p&&p.previewUrl&&URL.revokeObjectURL(p.previewUrl)},[null===p||void 0===p?void 0:p.previewUrl]);const N=function(){var e,a,i;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;const t=new Intl.DateTimeFormat("ko-KR",{timeZone:"Asia/Seoul",year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(l),s=(null===(e=t.find(e=>"year"===e.type))||void 0===e?void 0:e.value)||"",n=(null===(a=t.find(e=>"month"===e.type))||void 0===a?void 0:a.value)||"",r=(null===(i=t.find(e=>"day"===e.type))||void 0===i?void 0:i.value)||"";return"".concat(s,".").concat(n,".").concat(r)},f=()=>{if(!r)return;if(!o.trim()||0===u)return;const a=Date.now(),i={id:a,ts:a,name:(null===e||void 0===e?void 0:e.nickname)||(null===e||void 0===e?void 0:e.username)||(null===e||void 0===e?void 0:e.name)||"\uc0ac\uc6a9\uc790",text:o.trim(),rating:u,date:N(new Date(a)),image:(null===p||void 0===p?void 0:p.previewUrl)||null};c(e=>[i,...e]),v(""),m(0),h(null)},y=(0,t.useMemo)(()=>{const e=[...d];return"rating"===x?e.sort((e,a)=>a.rating!==e.rating?a.rating-e.rating:(a.ts||0)-(e.ts||0)):e.sort((e,a)=>(a.ts||0)-(e.ts||0)),e},[d,x]);return(0,n.jsxs)("div",{className:"review-page",children:[(0,n.jsxs)("div",{className:"review-toolbar",children:[(0,n.jsx)("h2",{className:"review-title",children:"\uc804\uccb4 \ub9ac\ubdf0"}),(0,n.jsxs)("div",{className:"review-sort",children:[(0,n.jsx)("label",{htmlFor:"sort",className:"sr-only",children:"\uc815\ub82c"}),(0,n.jsxs)("select",{id:"sort",value:x,onChange:e=>j(e.target.value),className:"review-sort-select",children:[(0,n.jsx)("option",{value:"latest",children:"\ucd5c\uc2e0\uc21c"}),(0,n.jsx)("option",{value:"rating",children:"\ubcc4\uc810\uc21c"})]})]})]}),(0,n.jsx)("div",{className:"review-list",children:0===y.length?(0,n.jsx)("p",{className:"review-empty",children:"\uc544\uc9c1 \ub9ac\ubdf0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."}):y.map(e=>(0,n.jsxs)("div",{className:"review-item",children:[(0,n.jsx)("div",{className:"review-avatar","aria-hidden":!0,children:"\ud83d\udc64"}),(0,n.jsxs)("div",{className:"review-content",children:[(0,n.jsxs)("div",{className:"review-top",children:[(0,n.jsx)("span",{className:"review-name",children:e.name}),(0,n.jsx)("span",{className:"review-date",children:e.date})]}),(0,n.jsxs)("div",{className:"review-stars readonly","aria-label":"\ubcc4\uc810 ".concat(e.rating,"\uc810"),children:["\u2605".repeat(e.rating),"\u2606".repeat(5-e.rating)]}),(0,n.jsx)("div",{className:"review-text",children:e.text}),e.image&&(0,n.jsx)("img",{src:e.image,alt:"\ub9ac\ubdf0 \uc774\ubbf8\uc9c0",className:"review-image",loading:"lazy"})]})]},e.id))}),(0,n.jsxs)("div",{className:"review-input-container ".concat(r?"":"disabled"),children:[i?(0,n.jsx)("div",{className:"review-guard",children:"\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911\u2026"}):r?null:(0,n.jsx)("div",{className:"review-guard",children:"\ub9ac\ubdf0\uc5b4\ub9cc \ub9ac\ubdf0\ub97c \uc791\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."}),(0,n.jsx)("div",{className:"star-rating",role:"radiogroup","aria-label":"\ubcc4\uc810 \uc120\ud0dd",children:[1,2,3,4,5].map(e=>(0,n.jsx)("button",{type:"button",className:e<=u?"star filled":"star",onClick:()=>(e=>m(e))(e),"aria-pressed":e<=u,"aria-label":"".concat(e,"\uc810"),children:"\u2605"},e))}),(0,n.jsx)("input",{type:"text",placeholder:"\ub9ac\ubdf0\ub97c \uc791\uc131\ud574\uc8fc\uc138\uc694",className:"review-input",value:o,onChange:e=>v(e.target.value),onKeyDown:e=>"Enter"===e.key&&f(),disabled:!r}),(0,n.jsxs)("div",{className:"review-file-row",children:[(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;const i=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!i)return void h(null);const l=URL.createObjectURL(i);h({file:i,previewUrl:l})},className:"review-file",disabled:!r}),(0,n.jsx)("button",{type:"button",className:"preview-btn",onClick:()=>g(!0),disabled:!r||!p,children:"\ubbf8\ub9ac\ubcf4\uae30"}),(null===p||void 0===p?void 0:p.file)&&(0,n.jsx)("span",{className:"file-name",title:p.file.name,children:p.file.name})]}),(0,n.jsx)("button",{onClick:f,className:"review-button",disabled:!r,children:"\ub4f1\ub85d"})]}),w&&(null===p||void 0===p?void 0:p.previewUrl)&&(0,n.jsx)("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",onClick:()=>g(!1),onKeyDown:e=>"Escape"===e.key&&g(!1),tabIndex:-1,children:(0,n.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("img",{src:p.previewUrl,alt:"\uc5c5\ub85c\ub4dc \uc774\ubbf8\uc9c0 \ubbf8\ub9ac\ubcf4\uae30"}),(0,n.jsx)("button",{type:"button",className:"modal-close",onClick:()=>g(!1),children:"\ub2eb\uae30"})]})})]})}function d(){return(0,n.jsx)("div",{"data-app":"map",children:(0,n.jsxs)(l.BV,{children:[(0,n.jsx)(l.qh,{index:!0,element:(0,n.jsx)(r,{})}),(0,n.jsx)(l.qh,{path:"*",element:(0,n.jsx)(l.C5,{to:".",replace:!0})})]})})}}}]);
//# sourceMappingURL=677.f79d209a.chunk.js.map